---
import { storyblokEditable, renderRichText } from "@storyblok/astro";
import GridImage from "../components/GridImage.astro";

interface GridCard {
  title: string;
  price: string;
  image: {
    filename: string;
    alt?: string;
  };
  imageAlt?: string;
  link?: {
    cached_url?: string;
    url?: string;
  };
}

import type { StoryblokRichTextNode } from "@storyblok/astro";

interface ImageGridProps {
  title: StoryblokRichTextNode;
  text?: string;
  grid_cards?: GridCard[];
  [k: string]: any;
}

const { blok } = Astro.props as { blok: ImageGridProps };
const { title, text, grid_cards } = blok;

const cards: GridCard[] = grid_cards || [];
---

<section {...storyblokEditable(blok)} class="vertical-p bg-red w-screen">
  <div class="site-container">
    <div class="lg:max-w-3/4 mx-auto">
      <div class="text-white" set:html={renderRichText(title)} />

      {text && <p class="text-white mt-4">{text}</p>}
      <div
        class="mt-12 grid grid-cols-1 md:grid-cols-2 mx-auto gap-8 md:gap-14"
      >
        {
          cards[0] && (
            <div class="block md:hidden">
              <GridImage
                card={cards[0]}
                link={cards[0].link}
                isFirst={false}
                isMobile={true}
              />
            </div>
          )
        }

        {
          cards[0] && (
            <div class="hidden md:block">
              <GridImage
                card={cards[0]}
                link={cards[0].link}
                isFirst={true}
                isMobile={false}
              />
            </div>
          )
        }

        <div class="flex flex-col gap-8 md:gap-12 lg:gap-12">
          {
            cards.slice(1, 3).map((card) => (
              <div class="flex-1">
                <GridImage
                  card={card}
                  link={card.link}
                  isFirst={false}
                  isMobile={false}
                />
              </div>
            ))
          }
        </div>
      </div>
    </div>
  </div>
</section>
