---
import { storyblokEditable } from "@storyblok/astro";
import Button from "../components/reusable/Button.astro";
import FeaturedCarCard from "../components/FeaturedCarCard.astro";

const { blok } = Astro.props;
const { title, header, description, featured_cars_button, featured_cars } =
    blok;

const showHr = !!header;

const displayCars = featured_cars || [];
const initialLimit = 3;
---

<section {...storyblokEditable(blok)} class="site-container vertical-p">
    <div>
        {
            header && (
                <p class="text-black font-semibold pb-2 md:pb-4">{header}</p>
            )
        }
        {showHr && <hr class="border-t border-black h-1 w-full pb-6 md:pb-8" />}

        <div>
                        <Fragment set:html={`<h2 class="text-gray">${title}</h2>`} />

                        {description && <p class={`text-gray mt-4`}>{description}</p>}

                        {
                displayCars.length > 0 && (
                    <div id="cars-container" class="mt-8">
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            {displayCars
                                .slice(0, initialLimit)
                                .map((car: any) => (
                                    <div class="car-item">
                                        <FeaturedCarCard car={car} />
                                    </div>
                                ))}
                        </div>
                    </div>
                )
            }
                        {
                featured_cars_button && featured_cars_button.length > 0 && (
                    <div class="mt-6 md:mt-12">
                        {
                            <Button
                                type={featured_cars_button[0].style}
                                buttonText={featured_cars_button[0].text}
                                link={
                                    "/" +
                                    featured_cars_button[0].link.cached_url
                                }
                            />
                        }
                    </div>
                )
            }
        </div>
    </div>
</section>
