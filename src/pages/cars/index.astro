---
import { getCollection } from 'astro:content';
import { Icon } from 'astro-icon/components';
import Button from '../../components/reusable/Button.astro';
import CarsShowcase from '../../components/CarsShowcase.astro';

// Get all cars
const allCars = await getCollection('cars');

// Get featured cars
const featuredCars = allCars.filter(car => car.data.featured);
---

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Premium Vehicle Collection - Our Cars</title>
  <meta name="description" content="Explore our exclusive collection of premium vehicles featuring luxury brands like Mercedes-Benz, Porsche, BMW, and Tesla." />
</head>
<body>

<!-- Hero Section -->
<section class="relative h-screen flex items-center justify-center overflow-hidden">
  <div class="absolute inset-0 bg-gradient-to-br from-primary via-primary/80 to-secondary"></div>

  <div class="relative z-10 text-center text-white px-4">
    <h1 class="text-5xl md:text-6xl lg:text-7xl font-bold mb-6">
      Premium Vehicle
      <span class="block text-secondary">Collection</span>
    </h1>
    <p class="text-xl md:text-2xl mb-8 max-w-3xl mx-auto opacity-90">
      Discover our curated selection of the world's finest automobiles,
      each representing the pinnacle of engineering excellence and luxury.
    </p>
    <div class="flex flex-col sm:flex-row gap-4 justify-center">
      <Button
        type="filled"
        buttonText="Explore Inventory"
        link="#inventory"
        arrow={true}
      />
      <Button
        type="outline"
        buttonText="Schedule Consultation"
        link="/consultation"
      />
    </div>
  </div>

  <!-- Stats -->
  <div class="absolute bottom-0 left-0 right-0 bg-black/20 backdrop-blur-sm">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8">
      <div class="grid grid-cols-2 lg:grid-cols-4 gap-8 text-white text-center">
        <div>
          <div class="text-3xl font-bold mb-2">{allCars.length}+</div>
          <div class="text-sm opacity-90">Premium Vehicles</div>
        </div>
        <div>
          <div class="text-3xl font-bold mb-2">{new Set(allCars.map(car => car.data.brand)).size}+</div>
          <div class="text-sm opacity-90">Luxury Brands</div>
        </div>
        <div>
          <div class="text-3xl font-bold mb-2">24/7</div>
          <div class="text-sm opacity-90">Support</div>
        </div>
        <div>
          <div class="text-3xl font-bold mb-2">100%</div>
          <div class="text-sm opacity-90">Satisfaction</div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Featured Vehicles -->
<CarsShowcase featured={true} />

<!-- Complete Inventory -->
<section id="inventory" class="py-16 lg:py-24 bg-gray-50">
  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-16">
      <h2 class="text-3xl font-bold text-gray-900 md:text-4xl lg:text-5xl mb-4">
        Complete Inventory
      </h2>
      <p class="text-lg text-gray-600 max-w-2xl mx-auto">
        Browse our entire collection of premium vehicles, each carefully selected for its exceptional quality and performance.
      </p>
    </div>

    <!-- Filter Options -->
    <div class="mb-12">
      <div class="flex flex-wrap gap-2 justify-center">
        <button class="px-6 py-2 bg-primary text-white rounded-full font-medium transition-colors">
          All Vehicles ({allCars.length})
        </button>
        {Array.from(new Set(allCars.map(car => car.data.brand))).map(brand => {
          const count = allCars.filter(car => car.data.brand === brand).length;
          return (
            <button class="px-6 py-2 bg-white text-gray-700 border border-gray-300 rounded-full font-medium hover:bg-gray-50 transition-colors">
              {brand} ({count})
            </button>
          );
        })}
      </div>
    </div>

    <!-- Cars Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
      {allCars.map((car) => (
        <div class="group bg-white rounded-xl shadow-md overflow-hidden transition-all duration-300 hover:shadow-xl hover:-translate-y-1">

          <!-- Car Image -->
          <div class="relative h-56 overflow-hidden">
            <div class="absolute inset-0 bg-gradient-to-t from-black/50 via-transparent to-transparent z-10"></div>

            {car.data.image.src ? (
              <img
                src={car.data.image.src}
                alt={car.data.image.alt}
                class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"
                loading="lazy"
              />
            ) : (
              <div class="w-full h-full bg-gray-200 flex items-center justify-center">
                <span class="text-gray-500">Image Coming Soon</span>
              </div>
            )}

            <!-- Quick Info Overlay -->
            <div class="absolute top-4 right-4 z-20">
              <span class="px-3 py-1 bg-primary/90 text-white text-xs font-medium rounded-full">
                {car.data.year}
              </span>
            </div>

            <div class="absolute bottom-4 left-4 right-4 z-20">
              <div class="text-white">
                <p class="text-sm font-medium opacity-90">{car.data.brand}</p>
                <h3 class="text-lg font-bold mb-1">{car.data.model}</h3>
                <p class="text-xl font-bold">{car.data.price}</p>
              </div>
            </div>
          </div>

          <!-- Car Details -->
          <div class="p-6">
            <h3 class="text-xl font-bold text-gray-900 mb-3">{car.data.title}</h3>

            <!-- Quick Specs -->
            <div class="grid grid-cols-2 gap-3 mb-4">
              <div class="flex items-center space-x-2 text-sm text-gray-600">
                <Icon name="power" class="w-4 h-4" />
                <span class="truncate">{car.data.specifications.power}</span>
              </div>
              <div class="flex items-center space-x-2 text-sm text-gray-600">
                <Icon name="speed" class="w-4 h-4" />
                <span>{car.data.specifications.acceleration}</span>
              </div>
            </div>

            <p class="text-gray-600 text-sm mb-4 line-clamp-2">
              {car.data.description}
            </p>

            <div class="flex gap-2">
              <Button
                type="filled"
                buttonText="View Details"
                link={`/cars/${car.id}`}
                class="flex-1"
              />
              <Button
                type="outline"
                buttonText="Test Drive"
                link={`/test-drive?car=${car.id}`}
                class="flex-1"
              />
            </div>
          </div>
        </div>
      ))}
    </div>
  </div>
</section>

<!-- CTA Section -->
<section class="py-16 lg:py-24 bg-primary text-white">
  <div class="mx-auto max-w-4xl px-4 sm:px-6 lg:px-8 text-center">
    <h2 class="text-3xl font-bold mb-6">
      Ready to Experience Luxury?
    </h2>
    <p class="text-xl mb-8 opacity-90">
      Schedule a personalized consultation or test drive with our automotive experts.
    </p>
    <div class="flex flex-col sm:flex-row gap-4 justify-center">
      <Button
        type="outline"
        buttonText="Book Test Drive"
        link="/test-drive"
        arrow={true}
      />
      <Button
        type="outline"
        buttonText="Contact Our Team"
        link="/contact"
      />
    </div>
  </div>
</section>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>

</body>
</html>